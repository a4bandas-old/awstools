global
  log 127.0.0.1  local0
  log 127.0.0.1  local1 notice
  maxconn 4096
  user haproxy
  group haproxy
  daemon
  stats socket /var/run/haproxy.sock

defaults
  log     global
  mode    http
  option  httplog
  option  forwardfor
  option  dontlognull
  option  httpclose
  option  redispatch
  retries 2
  maxconn 40000
  contimeout   10000
  clitimeout  300000
  srvtimeout  300000
  stats uri /ha_stats
  stats realm Global\ statistics
  stats auth haproxy:_password_

frontend web *:80
  acl acl_static  hdr_beg(host) -i   static
  acl acl_static  path_beg      -i   /images /javascripts /stylesheets /swf
  acl acl_static  path_end      -i   .gif .png .jpg .css .js .html .htm .swf

  use_backend farm_static if acl_static

  default_backend farm_app

backend farm_app
  option httpchk GET /activities HTTP/1.1\r\nHost:\ copaamerica2011.telefe.com
  balance roundrobin
  # telefe-autogenerated match: frontend template:  server srv-{host} {host}.private:80 maxconn 250 check inter 20000 fall 1 
  server srv-frontend1 frontend1.private:80 maxconn 250 check inter 20000 fall 1 
  server srv-frontend2 frontend2.private:80 maxconn 250 check inter 20000 fall 1 
  # telefe-autogenerated end

backend farm_static
  balance roundrobin
  server server-1-static 127.0.0.1:8000 maxconn 250 check

